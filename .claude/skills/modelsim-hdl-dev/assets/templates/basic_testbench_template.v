// Testbench Template for ModelSim
// Copy and modify for your design
// Generated by modelsim-hdl-dev skill

`timescale 1ns/1ps

module MODULE_NAME_tb;
    // ============================================
    // 1. Signals Declaration
    // ============================================

    // Clock and reset
    reg clk;
    reg rst_n;

    // DUT input signals
    // TODO: Add your input signals here
    // Example:
    // reg enable;
    // reg [7:0] data_in;

    // DUT output signals
    // TODO: Add your output signals here
    // Example:
    // wire [7:0] data_out;
    // wire valid;

    // Test control
    reg test_passed;
    integer test_count;
    integer error_count;

    // ============================================
    // 2. DUT Instantiation
    // ============================================

    MODULE_NAME dut (
        .clk(clk),
        .rst_n(rst_n)
        // TODO: Connect your signals
        // Example:
        // .enable(enable),
        // .data_in(data_in),
        // .data_out(data_out),
        // .valid(valid)
    );

    // ============================================
    // 3. Clock Generation
    // ============================================

    // 10ns period = 100MHz
    initial begin
        clk = 0;
        forever #5 clk = ~clk;
    end

    // To change frequency:
    // 1MHz (1us period):   forever #500 clk = ~clk;
    // 10MHz (100ns period): forever #50 clk = ~clk;
    // 50MHz (20ns period):  forever #10 clk = ~clk;

    // ============================================
    // 4. Test Sequence
    // ============================================

    initial begin
        $display("=== %s Testbench Start ===", "MODULE_NAME");

        // Initialize signals
        test_passed = 1;
        test_count = 0;
        error_count = 0;

        // Apply reset
        rst_n = 0;
        // TODO: Initialize other signals
        // enable = 0;
        // data_in = 8'h00;

        #20;  // Hold reset for 20ns

        // Release reset
        $display("Time: %0t - Releasing reset", $time);
        rst_n = 1;
        #10;

        // ====================================
        // TODO: Add your test cases here
        // ====================================

        // Test Case 1: Basic functionality
        $display("\n--- Test Case 1: Basic functionality ---");
        test_count = test_count + 1;

        // TODO: Your test code
        // Example:
        // enable = 1;
        // data_in = 8'h42;
        // #20;
        // if (data_out == 8'h42 && valid == 1'b1) begin
        //     $display("✓ Test 1 PASSED");
        // end else begin
        //     $display("✗ Test 1 FAILED: Expected data_out=0x42, valid=1, got data_out=0x%h, valid=%b",
        //              data_out, valid);
        //     test_passed = 0;
        //     error_count = error_count + 1;
        // end

        #100;

        // Test Case 2: Edge cases
        $display("\n--- Test Case 2: Edge cases ---");
        test_count = test_count + 1;

        // TODO: Your edge case tests

        #100;

        // Test Case 3: Reset during operation
        $display("\n--- Test Case 3: Reset functionality ---");
        test_count = test_count + 1;

        // TODO: Test reset behavior
        // Example:
        // rst_n = 0;
        // #20;
        // rst_n = 1;
        // #20;
        // if (data_out == 8'h00) begin
        //     $display("✓ Test 3 PASSED - Reset works correctly");
        // end else begin
        //     $display("✗ Test 3 FAILED - Reset did not clear output");
        //     test_passed = 0;
        //     error_count = error_count + 1;
        // end

        #100;

        // ====================================
        // Test Completion
        // ====================================

        $display("\n=== %s Testbench Complete ===", "MODULE_NAME");
        $display("Tests run: %0d", test_count);
        $display("Errors: %0d", error_count);

        // IMPORTANT: Add TEST_RESULT marker for automatic verification
        // This enables Claude to autonomously verify the simulation
        if (test_passed && error_count == 0) begin
            $display("TEST_RESULT: PASS - All tests passed (%0d/%0d)", test_count, test_count);
        end else begin
            $display("TEST_RESULT: FAIL - %0d/%0d tests failed", error_count, test_count);
        end

        $finish;
    end

    // ============================================
    // 5. Watchdog Timer
    // ============================================

    // Prevents infinite loops - adjust timeout as needed
    initial begin
        #100000;  // 100us timeout
        $display("\nERROR: Testbench timeout after 100us!");
        $display("TEST_RESULT: FAIL - Timeout");
        $finish;
    end

    // ============================================
    // 6. Optional: Monitoring and Assertions
    // ============================================

    // Monitor critical signals
    // initial begin
    //     $monitor("Time: %0t | clk=%b rst_n=%b enable=%b data_out=0x%h valid=%b",
    //              $time, clk, rst_n, enable, data_out, valid);
    // end

    // Assertions (SystemVerilog)
    // assert property (@(posedge clk) disable iff (!rst_n)
    //     enable |-> ##1 valid)
    //     else $error("Valid signal did not assert after enable");

endmodule
